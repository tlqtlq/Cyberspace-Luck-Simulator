<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Discord Auth - Processing</title>
    <script>
        // This is a SIMULATION for GitHub Pages.
        // In production, this page would receive a 'code' from Discord,
        // send it to YOUR backend server, which would then exchange it for
        // the user's REAL Discord data (username, avatar, discriminator, etc.).

        // For now, we simulate a successful login with realistic data.
        const simulatedDiscordData = {
            id: 'discord_' + Date.now(),
            username: 'CyberPioneer', // Simulated Discord username
            discriminator: '1234',    // Simulated discriminator
            avatar: null,             // In production, this would be an avatar hash or URL
            global_name: 'Cyber Pioneer' // Simulated global display name
        };

        // Construct the full username (e.g., CyberPioneer#1234)
        const fullUsername = `${simulatedDiscordData.username}#${simulatedDiscordData.discriminator}`;

        // Construct avatar URL (if avatar existed)
        // In production: `https://cdn.discordapp.com/avatars/${userId}/${avatarHash}.png`
        const avatarUrl = simulatedDiscordData.avatar
            ? `https://cdn.discordapp.com/avatars/${simulatedDiscordData.id}/${simulatedDiscordData.avatar}.png`
            : null;

        // Prepare user data to send back to the main app
        const userData = {
            username: fullUsername,
            discordUsername: simulatedDiscordData.username,
            discordDiscriminator: simulatedDiscordData.discriminator,
            discordId: simulatedDiscordData.id,
            avatarUrl: avatarUrl, // Will be null in simulation
            globalName: simulatedDiscordData.global_name,
            isGuest: false,
            timestamp: new Date().toISOString()
        };

        // Save to localStorage (shared with main app for demo)
        localStorage.setItem('cyberspaceUser', JSON.stringify(userData));

        // Send the data back to the main application window and close this popup
        if (window.opener && !window.opener.closed) {
            window.opener.postMessage({
                type: 'DISCORD_AUTH_COMPLETE',
                user: userData
            }, '*'); // In production, replace '*' with your exact origin for security
        }

        // Auto-close the popup after a short delay
        setTimeout(() => {
            window.close();
        }, 1500);
    </script>
    <style>
        body {
            background: #0a0e17;
            color: white;
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }
        .container {
            text-align: center;
            background: rgba(0, 20, 40, 0.9);
            padding: 40px;
            border-radius: 10px;
            border: 2px solid #00f2ff;
            box-shadow: 0 0 20px rgba(0, 242, 255, 0.3);
            max-width: 500px;
        }
        .success {
            color: #22c55e;
            font-size: 24px;
            margin: 20px 0;
        }
        .loading {
            font-size: 18px;
            color: #00f2ff;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Discord Authentication</h1>
        <div class="success">âœ“ Authentication Successful!</div>
        <p class="loading">Welcome, CyberPioneer#1234!</p>
        <p>This window will close automatically...</p>
    </div>
</body>
</html>
